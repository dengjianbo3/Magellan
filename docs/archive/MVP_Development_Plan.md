### **AI投资报告Agent - MVP分阶段开发计划**

#### 核心思想
本开发计划遵循**“由内而外，先通后精”**的原则：
1.  **由内而外：** 先构建最核心的、被最多服务依赖的“原子能力”（如LLM网关），再构建调用它们的“编排服务”，最后才是用户直接接触的“前端应用”。
2.  **先通后精：** 在每个阶段，目标是尽快打通一个可以从头跑到尾的最小数据流（端到端可测），然后再逐步完善和丰富每个模块的功能。

---

### **阶段一：核心后端能力建设 (Backend Foundation)**

**目标：** 搭建后端核心服务，打通最基础的“文件上传 -> 文本提取 -> LLM调用”数据流。此阶段结束时，开发人员应能通过API接口，上传一个PDF，并获得由LLM总结的文本内容。

*   **Sprint 1: 基础设施与核心服务部署**
    1.  **任务1 (DevOps):** 搭建项目脚手架。初始化Git仓库，配置CI/CD流水线，部署API网关、消息队列(RabbitMQ)、数据库(PostgreSQL)和对象存储(MinIO/S3)。
    2.  **任务2 (后端):** 开发 **文件接收与存储服务**。实现一个API端点，能接收文件，存入对象存储，并返回`file_id`。
    3.  **任务3 (后端):** 开发 **LLM网关服务**。封装对至少一种LLM（如GPT）的API调用，提供一个统一的内部调用接口。**这是最核心的原子能力，被上层业务严重依赖。**

*   **Sprint 2: 打通第一个端到端数据流 (PDF -> Text)**
    1.  **任务1 (后端):** 开发 **PDF解析服务 (V1)**。实现基础功能：接收`file_id`，从对象存储拉取文件，提取纯文本。暂不处理复杂表格和OCR。
    2.  **任务2 (后端):** 开发 **报告编排服务 (V1)**。实现一个最简单的编排逻辑：
        *   接收一个包含`file_id`的API请求。
        *   调用**文件接收服务**（模拟）。
        *   将解析任务放入**消息队列**。
        *   **PDF解析服务**消费消息，完成后将结果存入数据库。
        *   **编排服务**拿到解析后的文本，调用**LLM网关服务**进行简单总结。
        *   将LLM的结果返回。
    3.  **里程碑测试：** **此Sprint结束时，必须能通过工具（如Postman）调用编排服务的API，上传一个PDF，最终能返回该PDF内容的AI摘要。这个链路的打通是本阶段成功的关键标志。**

---

### **阶段二：丰富数据源与核心业务逻辑 (Data & Business Logic)**

**目标：** 接入更多类型的数据源，并实现报告生成的核心业务逻辑。此阶段结束时，后端应能根据多个源（PDF, Excel, 公开数据）生成一份结构化的、包含多个章节的JSON格式报告。

*   **Sprint 3: 扩展文件解析与数据聚合**
    1.  **任务1 (后端):** 开发 **Excel解析服务 (V1)** 和 **Word解析服务 (V1)**。实现基础的文本和数据提取。
    2.  **任务2 (后端):** 开发 **公开数据聚合服务 (V1)**。实现根据公司名称，抓取关键的公开信息（如公司简介）。
    3.  **任务3 (后端):** 升级 **报告编排服务 (V2)**。使其能同时处理多种文件类型和公开数据，将所有来源的信息整合在一起。

*   **Sprint 4: 实现核心报告生成逻辑**
    1.  **任务1 (后端):** 升级 **报告编排服务 (V3)**。设计并实现完整的报告生成模板，为“公司简介”、“行业分析”、“风险评估”等每个章节构建不同的Prompt，并调用**LLM网关服务**生成内容。
    2.  **任务2 (后端):** 开发 **可视化图表生成服务 (V1)**。能根据输入的数据生成一个简单的饼图。
    3.  **任务3 (后端):** **报告编排服务 (V3)** 集成图表生成能力。
    4.  **里程碑测试：** **此Sprint结束时，调用编排服务的API，输入公司名和多个文件，应能返回一个结构完整的、包含图表链接的JSON格式报告草稿。**

---

### **阶段三：前端开发与用户体验 (Frontend & UX)**

**目标：** 开发用户界面，将后端强大的能力呈现给用户。此阶段结束时，我们应该有一个可供种子用户测试的、功能完整的MVP产品。

*   **Sprint 5: 用户认证与报告创建页面**
    1.  **任务1 (后端):** 开发 **用户认证与画像服务 (V1)**。实现用户注册、登录和JWT签发。
    2.  **任务2 (前端):** 搭建前端项目框架（React/Vue）。开发用户注册、登录页面，并能与后端服务联调。
    3.  **任务3 (前端):** 开发 **创建新报告** 的主界面。实现公司名称输入和文件上传组件（调用**文件接收服务**）。点击“生成”按钮后，能向**报告编排服务**发送请求。

*   **Sprint 6: 报告展示与完整MVP**
    1.  **任务1 (前端):** 开发 **报告展示页面**。能接收后端返回的JSON格式报告，并将其渲染成一个带目录、图文并茂的网页。
    2.  **任务2 (前端):** 实现报告生成过程中的等待状态反馈（如进度条）。
    3.  **任务3 (前端):** 开发 **新用户引导与画像建立** 流程。
    4.  **里程碑测试：** **此Sprint结束时，一个新用户应该可以完成注册 -> 建立画像 -> 创建报告 -> 等待 -> 查看完整报告 的全部流程。整个产品MVP功能闭环。**
